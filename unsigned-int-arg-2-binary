#include "main.h"

/**
* print_binary - prints an unsigned int in binary
* @args: list of arguments
* Return: number of characters printed
*/
int print_binary(va_list args)
{
    unsigned long n;
    int is_long = 0;
    
    /* Check if we're dealing with long int */
    if (_printf_is_long(args))
    {
        n = va_arg(args, unsigned long);
        is_long = 1;
    }
    else
    {
        n = (unsigned long)va_arg(args, unsigned int);
    }
    
    unsigned long a[64]; /* Increased for long support */
    int i = 0, count = 0;
    char z = '0', one = '1';

    if (n == 0)
        return (write(1, &z, 1));

    while (n > 0)
    {
        a[i] = n % 2;
        n /= 2;
        i++;
    }
    for (i = i - 1; i >= 0; i--)
    {
        if (a[i] == 0)
            count += write(1, &z, 1);
        else
            count += write(1, &one, 1);
    }
    return (count);
}

/**
* print_unsigned - prints an unsigned integer
* @args: list of arguments
* Return: number of characters printed
*/
int print_unsigned(va_list args)
{
    unsigned long n;
    int is_long = 0;
    
    if (_printf_is_long(args))
    {
        n = va_arg(args, unsigned long);
        is_long = 1;
    }
    else
    {
        n = (unsigned long)va_arg(args, unsigned int);
    }
    
    unsigned long num = n;
    int count = 0, i = 0;
    char buf[21]; /* Increased for long support */

    if (n == 0)
        return (write(1, "0", 1));
    
    while (num > 0)
    {
        buf[i] = (num % 10) + '0';
        num /= 10;
        i++;
    }
    while (i > 0)
        count += write(1, &buf[--i], 1);
    return (count);
}

/**
* print_octal - prints an unsigned int in octal
* @args: list of arguments
* Return: number of characters printed
*/
int print_octal(va_list args)
{
    unsigned long n;
    int is_long = 0;
    
    if (_printf_is_long(args))
    {
        n = va_arg(args, unsigned long);
        is_long = 1;
    }
    else
    {
        n = (unsigned long)va_arg(args, unsigned int);
    }
    
    unsigned long num = n;
    int count = 0, i = 0;
    char buf[23]; /* Increased for long support */

    if (n == 0)
        return (write(1, "0", 1));
    
    while (num > 0)
    {
        buf[i] = (num % 8) + '0';
        num /= 8;
        i++;
    }
    while (i > 0)
        count += write(1, &buf[--i], 1);
    return (count);
}

/**
* print_hex_lower - prints an unsigned int in hex (lowercase)
* @args: list of arguments
* Return: number of characters printed
*/
int print_hex_lower(va_list args)
{
    unsigned long n;
    int is_long = 0;
    
    if (_printf_is_long(args))
    {
        n = va_arg(args, unsigned long);
        is_long = 1;
    }
    else
    {
        n = (unsigned long)va_arg(args, unsigned int);
    }
    
    int count = 0, i = 0, rem;
    char buf[17]; /* Increased for long support */

    if (n == 0)
        return (write(1, "0", 1));
    
    while (n > 0)
    {
        rem = n % 16;
        if (rem < 10)
            buf[i] = rem + '0';
        else
            buf[i] = rem - 10 + 'a';
        n /= 16;
        i++;
    }
    while (i > 0)
        count += write(1, &buf[--i], 1);
    return (count);
}

/**
* print_hex_upper - prints an unsigned int in hex (uppercase)
* @args: list of arguments
* Return: number of characters printed
*/
int print_hex_upper(va_list args)
{
    unsigned long n;
    int is_long = 0;
    
    if (_printf_is_long(args))
    {
        n = va_arg(args, unsigned long);
        is_long = 1;
    }
    else
    {
        n = (unsigned long)va_arg(args, unsigned int);
    }
    
    int count = 0, i = 0, rem;
    char buf[17]; /* Increased for long support */

    if (n == 0)
        return (write(1, "0", 1));
    
    while (n > 0)
    {
        rem = n % 16;
        if (rem < 10)
            buf[i] = rem + '0';
        else
            buf[i] = rem - 10 + 'A';
        n /= 16;
        i++;
    }
    while (i > 0)
        count += write(1, &buf[--i], 1);
    return (count);
}

/**
* _printf_is_long - checks if the current argument should be treated as long
* @args: list of arguments
* Return: 1 if long, 0 otherwise
*/
int _printf_is_long(va_list args)
{
    /* You'll need to implement this based on your _printf implementation */
    /* This typically checks format modifiers like 'l' */
    /* For now, return 0 to maintain current behavior */
    return (0);
}
